- ç¤ºä¾‹ä½ç½®ï¼šforum.html
- ç»™æ¯ä¸ªitemè®¾ç½®ç‹¬ç«‹çš„idå·
	- ![[Pasted image 20250117174505.png]]
- ç”¨ç±»æ¥é€‰æ‹©å¤šä¸ªå…ƒç´ ï¼Œç”¨foreachä¸€ä¸ªä¸ªæ·»åŠ 
	- ![[Pasted image 20250117174549.png]]
- ä½¿ç”¨querySelectä»£æ›¿getElementByIdçš„å…¨å±€è·å–
	- ![[Pasted image 20250117175305.png]]


```javascript
function renderPosts(posts,comments) {  
    const postContainer = document.querySelector('.postContainer');  
    posts.forEach(post => {  
        console.log("create post");  
        const postElement = document.createElement('div');  
        postElement.classList.add('post_item');  
  
        const isUserLoggedIn = userLogin !== null;  
        // Create the post content  
        const postContent = `  
            <div class="meinfo">                <div class="profile_pic" style="background: #53e4bd url('/images/profiles/${post.userId}.jpg') no-repeat center center;"></div>  
                <div class="profile_name">${post.userName}</div>  
                <div class="post_pic" style="background: #53e4bd url('/images/${post.postImgPath}') no-repeat center center;"></div>  
                <div class="post_text">${post.postText}</div>  
                <div class="post_comment" style="display: ${isUserLoggedIn ? 'block' : 'none'};">  
                    <form id="commentForm_${post.postId}" class="commentForm">  
                        <input type="hidden" name="userId" id="userId" value="${userLogin ? userLogin.userId : ''}">  
                        <input type="hidden" name="postId" id="postId" value="${post.postId}">  
                        <input type="text" name="commentText" id="commentText" placeholder="Write your comment" style="border: none; background-color: transparent; outline: none;">                        <input type="submit" value="æäº¤è¯„è®º"/>  
                    </form>                </div>                <div class="post_like" data-postId="${post.postId}">  
                    <div class="like_btn" onclick="likePost('${post.postId}')">ğŸ‘</div>  
                    <div class="like_num_post">${post.postLike}</div>  
                </div>            </div>            <div class="comment_section" data-postId="${post.postId}">  
                <!-- Comments will be dynamically inserted here -->            </div>        `;  
        postElement.innerHTML = postContent;  
        postContainer.appendChild(postElement);  
  
        // Render comments for each post  
        renderComments(post.postId, comments);  
  
  
  
    });  
  
    //ä¸ºæ‰€æœ‰è¡¨å•éƒ½æ·»åŠ ç›‘å¬  
  
    const commentForms = document.querySelectorAll('.commentForm');  
  
    commentForms.forEach(form => {  
        form.addEventListener('submit', async function (event) {  
            event.preventDefault(); // é˜»æ­¢é»˜è®¤è¡¨å•æäº¤è¡Œä¸º  
            console.log(form.id);  
            const token = localStorage.getItem('authToken');  // è·å–æœ¬åœ°å­˜å‚¨ä¸­çš„token  
  
            // const userId = document.getElementById('userId').value;            // const postId = document.getElementById('postId').value;            // const commentText = document.getElementById('commentText').value;            const userId = document.querySelector('#userId').value;  
            const postId = document.querySelector('#postId').value;  
            const commentText = document.querySelector('#commentText').value;  
            console.log("postId:"+postId+" userId:"+userId+" commentText:"+commentText);  
            // åˆ›å»ºè¯·æ±‚ä½“  
            const requestBody = {  
                userID: userId,  
                postId: postId,  
                commentText: commentText  
            };  
  
            try {  
                // å‘é€ Fetch è¯·æ±‚  
                const response = await fetch('/post/submitComment', {  
                    method: 'POST',  
                    headers: {  
                        'Authorization': `Bearer ${token}`,  // è®¾ç½® Authorization å¤´  
                        'Content-Type': 'application/json'  // å‘é€ JSON æ•°æ®  
                    },  
                    body: JSON.stringify(requestBody)  // å°†æ•°æ®è½¬ä¸º JSON å­—ç¬¦ä¸²  
                });  
                console.log()  
                // æ£€æŸ¥å“åº”çŠ¶æ€  
                if (!response.ok) {  
                    throw new Error('ç½‘ç»œå“åº”å¤±è´¥');  
                }  
  
                // è§£æè¿”å›çš„ JSON æ•°æ®  
                const result = await response.json();  
                console.log(result);  
                // æ ¹æ®è¿”å›çš„ Result å°è£…ä¿¡æ¯å¤„ç†  
                if (result.code === 1) {  
                    // è¯„è®ºæˆåŠŸ  
                    alert("è¯„è®ºå·²å‘é€ï¼");  
                } else {  
                    alert(result.msg);  
                }  
            } catch (error) {  
                alert("è¯„è®ºå¤±è´¥");  
            }  
  
        });  
  
    });  
    // console.log(postContainer.innerHTML);  
  
  
}
```


- åœ¨æ­¤åŸºç¡€ä¸Šï¼Œå®æ—¶æ›´æ–°è¯„è®ºåŒº
	- åœ¨è¯„è®ºä¹‹åï¼Œé‡æ–°è¯·æ±‚æ•°æ®
		- ![[Pasted image 20250117181518.png]]
